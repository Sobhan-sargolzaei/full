import numpy as np
import cv2

def contrast_stretching_loop(image, l_min=0, l_max=255):
    """
    اعمال کنتراست استرچینگ با استفاده از حلقه
    """
    i_min, i_max = np.min(image), np.max(image)
    rows, cols = image.shape
    result = np.zeros_like(image, dtype=np.uint8)

    for i in range(rows):
        for j in range(cols):
            result[i, j] = ((image[i, j] - i_min) / (i_max - i_min)) * (l_max - l_min) + l_min

    return result

def contrast_stretching_matrix(image, l_min=0, l_max=255):
    """
    اعمال کنتراست استرچینگ با استفاده از ماتریس
    """
    i_min, i_max = np.min(image), np.max(image)
    result = ((image - i_min) / (i_max - i_min)) * (l_max - l_min) + l_min
    return result.astype(np.uint8)

# تست برنامه
if __name__ == "__main__":
    # بارگذاری تصویر
    image = cv2.imread("image.jpg", cv2.IMREAD_GRAYSCALE)

    # اجرای روش حلقه
    stretched_loop = contrast_stretching_loop(image)

    # اجرای روش ماتریسی
    stretched_matrix = contrast_stretching_matrix(image)

    # نمایش تصاویر
    cv2.imshow("Original", image)
    cv2.imshow("Contrast Stretching - Loop", stretched_loop)
    cv2.imshow("Contrast Stretching - Matrix", stretched_matrix)
    cv2.waitKey(0)
    cv2.destroyAllWindows()